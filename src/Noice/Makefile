#-----------------------------------------------------------------
# File:    Makefile
# Author:  David Burnette
# Date:    April 7, 2008
#
# Description:
#  This makefile generates a VHDL file from assembler source.
#  A translate rule in mktargets.mk handles compiling the .asm
#  into a S19 record file (.S19) and then running s19tovhd to
#  generate a VHDL file with SPARTAN3 block rams with INIT generics
#  containing the binary data.
#
#  This particular makefile handles generating the Noice debug rom.
#
# Usage:
#  This make file is called recursively by the board-specific
#  makefiles in the 'rtl' directory. The targets generated by
#  this makefile are:
#
#    make                     - makes all variants
#    make all                 - makes all variants
#    make MON6809.vhd         - make the Noice rom 
#
# Target Descriptions:
#  The first file listed is the source file passed to assembler.
#  Remaining files are the dependencies. The option variables
#  ADDRS, ENTITY and TOP_RAM are used by the s19tovhd utility
#  to generate the VHDL file.
#
# Dependencies:
#  This makefile depends on def_rules.mk and the top-level
#  ram model file mon_rom_vhd.
#
# Revision History:
#   dgb 2008-04-07   Original version
#
#-----------------------------------------------------------------

ifeq "$(MKFRAGS)" ""
MKFRAGS := ../../mkfiles
endif

include $(MKFRAGS)/def_rules.mk

all: MON6809.vhd

MON6809.vhd: MON6809.ASM
MON6809.vhd: ADDRS=F000 F800
MON6809.vhd: ENTITY=NOICE6809
MON6809.vhd: TOP_RAM=noice_rom_vhd

.PHONY: clean
clean:
	-$(RM) *.S19
	-$(RM) *.lst
	-$(RM) *.vhd
